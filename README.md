# СТП анализатор

Приложение на Python 3.11 для офлайн-расчёта СТП и показателей кучности по фото бумажной мишени. GUI реализован на PyQt6, обработка изображений — OpenCV/NumPy, отчёты — CSV/PDF/DOCX.

## Запуск окружения

```bash
python3 -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

## Структура

- `app/main.py` — входная точка (PyQt6).
- `app/camera.py` — работа с камерой.
- `app/processing/` — этапы конвейера: выравнивание, порог, детект, метрики, оверлеи.
- `app/ui/` — графический интерфейс (главное окно, интерактивный вид).
- `app/export/` — экспорт отчётов.
- `app/settings.json` — конфигурация по умолчанию.
- `results/` — готовые отчёты и изображения.

## Разработка и тесты

```bash
pytest
```

## Сборка (PyInstaller)

```bash
pyinstaller --name stp_analyzer --onefile app/main.py
```

Рекомендуется включить требуемые зависимости в `.spec` после первого запуска PyInstaller.

## Базовый сценарий использования

1. Запустите `python -m app.main`.
2. Выберите/сделайте эталон (`Загрузить эталон`).
3. Снимите кадр или загрузите файл мишени.
4. Выполните обработку (`Обработать`).
5. При необходимости скорректируйте точки вручную (ЛКМ — добавить, ПКМ — удалить, перетаскивание — переместить).
6. Экспортируйте результаты в CSV/PDF/DOCX.

## Калибровка

Задайте реальные размеры (шаг сетки, диапазон диаметров) в `app/settings.json`. Масштаб в мм/пикс сохранится в разделе `calibration`. Для смены камеры/разрешения обновите `processing.target_resolution` и `active_camera_id`.

